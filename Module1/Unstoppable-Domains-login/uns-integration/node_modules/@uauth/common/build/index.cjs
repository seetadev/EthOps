var r=/*#__PURE__*/function(){function r(e){void 0===e&&(e=r.defaultCreateUrl),this.createURL=void 0,this.createURL=e}return r.defaultCreateUrl=function(r,e){return"https://"+r+".ipns.dweb.link"+e.replace(/^\/?/,"/")},r.prototype.resolve=function(r){try{var e,t,n;if(r.startsWith("/ipfs/")||r.startsWith("/ipns/"))n=r.substring(1,5),e=r.substring(6).split("/")[0],t=r.substring(6+e.length);else{var o=new URL(r);if(""!==o.hash||""!==o.password||""!==o.port||""!==o.search||""!==o.username)throw new Error("invalid ipfs uri");n=o.protocol.substring(0,4),e=o.hostname,t=o.pathname}if("ipfs"!==n)throw new Error("only ipfs is supported, (not ipns)");return Promise.resolve(fetch(this.createURL(e,t)).then(function(r){return r.ok?r.text():Promise.reject(new Error("bad response"))}))}catch(r){return Promise.reject(r)}},r}(),e=/*#__PURE__*/function(){function r(r){this.options=void 0,this.options=r}return r.prototype.resolve=function(r,e){try{var t,n="";if(r.includes("@")){var o=r.split("@",1);n=o[0],t=o[1]}else t=r;var i="http://openid.net/specs/connect/1.0/issuer";return Promise.resolve(this.options.webfingerResolver.resolve(t,n,i,e)).then(function(r){var e,t=null==(e=r.links)?void 0:e.find(function(r){return r.rel===i});if(!t||!t.href)throw new Error("bad jrd");return Promise.resolve(fetch(t.href+"/.well-known/openid-configuration").then(function(r){return r.ok?r.json():Promise.reject(new Error("bad openid-configuration response"))}))})}catch(r){return Promise.reject(r)}},r}();function t(r,e,o){if(!r.s){if(o instanceof n){if(!o.s)return void(o.o=t.bind(null,r,e));1&e&&(e=o.s),o=o.v}if(o&&o.then)return void o.then(t.bind(null,r,e),t.bind(null,r,2));r.s=e,r.v=o;const i=r.o;i&&i(r)}}var n=/*#__PURE__*/function(){function r(){}return r.prototype.then=function(e,n){var o=new r,i=this.s;if(i){var s=1&i?e:n;if(s){try{t(o,1,s(this.v))}catch(r){t(o,2,r)}return o}return this}return this.o=function(r){try{var i=r.v;1&r.s?t(o,1,e?e(i):i):n?t(o,1,n(i)):t(o,2,i)}catch(r){t(o,2,r)}},o},r}();if("undefined"!=typeof window){var o=window;o.UAUTH_VERSION=o.UAUTH_VERSION||{},o.UAUTH_VERSION.COMMON="2.3.0"}var i=/*#__PURE__*/function(){function r(r){this.options=void 0,this.options=r}return r.prototype.resolve=function(r,e,o,i){try{var s=this,u="webfinger."+e+"."+o;return Promise.resolve(s.options.domainResolver.records(r,[u])).then(function(f){function a(r){if(h.subject!==c)throw new Error("resource invalid");return h}var c=e?"acct:"+e+"@"+r:""+r;if(!f[u])return{subject:c,links:[{rel:o,href:i}]};var h,v=JSON.parse(f[u]),p="string"==typeof v.host?Promise.resolve(fetch("/.well-known/webfinger?"+new URLSearchParams({resource:c,rel:o}).toString(),{headers:{Host:v.host}}).then(function(r){return r.ok?r.json():Promise.reject(new Error("bad webfinger response"))})).then(function(r){h=r}):function(){if("string"==typeof v.uri){var r=new URL(v.uri);return function(r,e){var o,i=-1;r:{for(var s=0;s<e.length;s++){var u=e[s][0];if(u){var f=u();if(f&&f.then)break r;if(f===r){i=s;break}}else i=s}if(-1!==i){do{for(var a=e[i][1];!a;)i++,a=e[i][1];var c=a();if(c&&c.then){o=!0;break r}var h=e[i][2];i++}while(h&&!h());return c}}var v=new n,p=t.bind(null,v,2);return(o?c.then(l):f.then(function n(o){for(;;){if(o===r){i=s;break}if(++s===e.length){if(-1!==i)break;return void t(v,1,a)}if(u=e[s][0]){if((o=u())&&o.then)return void o.then(n).then(void 0,p)}else i=s}do{for(var f=e[i][1];!f;)i++,f=e[i][1];var a=f();if(a&&a.then)return void a.then(l).then(void 0,p);var c=e[i][2];i++}while(c&&!c());t(v,1,a)})).then(void 0,p),v;function l(r){for(;;){var n=e[i][2];if(!n||n())break;i++;for(var o=e[i][1];!o;)i++,o=e[i][1];if((r=o())&&r.then)return void r.then(l).then(void 0,p)}t(v,1,r)}}(r.protocol,[[function(){return"http:"}],[function(){return"https:"},function(){return Promise.resolve(fetch(r.toString()).then(function(r){return r.ok?r.json():Promise.reject(new Error("bad webfinger response"))})).then(function(r){h=r})}],[function(){return"ipfs:"},function(){return Promise.resolve(s.options.ipfsResolver.resolve(v.uri)).then(function(r){h=JSON.parse(r)})}],[function(){return"ipns:"}],[function(){return"swarm:"}],[void 0,function(){throw new Error("uri scheme not supported")}]])}if("string"!=typeof v.value)throw new Error("bad webfinger record");h=JSON.parse(v.value)}();return p&&p.then?p.then(a):a()})}catch(r){return Promise.reject(r)}},r}();function s(){return s=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},s.apply(this,arguments)}var u=/*#__PURE__*/function(){function r(){var r=this;this.map=new Map,this.records=function(e,t){try{var n=r.map.get(e);if(0===t.length)throw new Error("no keys");return Promise.resolve(n?t.reduce(function(r,e){return r[e]=n[e]||"",r},{}):{})}catch(r){return Promise.reject(r)}}}return r.prototype.set=function(r,e){this.map.has(r)?this.map.set(r,s({},this.map.get(r),e)):this.map.set(r,e)},r}(),f=/*#__PURE__*/function(){function r(){this.map=new Map}var e=r.prototype;return e.set=function(r,e,t,n){this.map.set(r+"."+e+"."+t,n)},e.resolve=function(r,e,t,n){try{var o=this.map.get(r+"."+e+"."+t);return Promise.resolve(o||{subject:r,links:[{rel:t,href:n}]})}catch(r){return Promise.reject(r)}},r}();exports.DefaultIPFSResolver=r,exports.DefaultIssuerResolver=e,exports.DefaultWebFingerResolver=i,exports.MemoryDomainResolver=u,exports.MemoryWebFingerResolver=f,exports.isJRD=function(r){return!0},exports.isJRDLink=function(r){return!0};
//# sourceMappingURL=index.cjs.map
